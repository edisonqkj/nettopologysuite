namespace GisSharpBlog.NetTopologySuite.Tests.Various
{
    using NetTopologySuite.IO;
    using NUnit.Framework;

    [TestFixture]
    public class Issue58Tests
    {
        private WKTReader reader;

        [TestFixtureSetUp]
        public void FixtureSetup()
        {
            this.reader = new WKTReader();
        }

        [Test]
        public void IsValidTest()
        {
            const string wkt1 = @"POLYGON ((34.4599206749855 
31.5052751195827, 34.4591251183673 31.505876611193, 34.4564127638305 
31.5080004493462, 34.4537439626941 31.5101644632323, 34.4511195275254 
31.5123679963883, 34.4485402576016 31.5146103803175, 34.4460069386666 
31.5168909346892, 34.4435203426915 31.5192089675434, 34.4410812276395 
31.5215637754978, 34.4386903372342 31.5239546439589, 34.4363484007321 
31.5263808473365, 34.4340561326997 31.5288416492612, 34.4318142327941 
31.5313363028058, 34.4523940586416 31.5446327903823, 34.418652699709 
31.5435956152166, 34.418607869166 31.543986448727, 34.4183101561582 
31.5471479227217, 34.41807689871 31.5503133628077, 34.4179081743761 
31.5534818051185, 34.4684965987297 31.5550365336316, 34.4684965987297 
31.5550365336316, 34.5025922837571 31.5770655272557, 34.5025922837571 
31.5770655272557, 34.5422799720196 31.6027074766985, 34.5431747791894 
31.5880715000537, 34.5685729895296 31.5765362132154, 34.55930848337 
31.5578274453506, 34.6065677538988 31.5592798593432, 34.6185283279689 
31.5538476398758, 34.6104027450397 31.5494898172092, 34.5543261354984 
31.5477660790837, 34.5465936184665 31.532151014053, 34.5475930100184 
31.51580439558, 34.5352102504765 31.5091634110899, 34.5295489583641 
31.4977309830554, 34.5480899795286 31.507675678701, 34.5487682794976 
31.4965810173711, 34.6079153103621 31.519202679428, 34.6040625393342 
31.5129853907695, 34.5085166118414 31.4001059322511, 34.5059238988558 
31.4016307845592, 34.5029221486902 31.4034629329153, 34.4999580174807 
31.4053396664381, 34.4970324062088 31.4072604160639, 34.4941462043379 
31.409224599348, 34.491300289545 31.4112316206391, 34.4884955274549 
31.4132808712574, 34.4857327713778 31.4153717296767, 34.4830128620515 
31.4175035617108, 34.4803366273856 31.4196757207029, 34.4777048822103 
31.4218875477197, 34.4751184280291 31.4241383717488, 34.4725780527743 
31.4264275098994, 34.4700845305673 31.4287542676074, 34.4676386214824 
31.4311179388436, 34.4652410713149 31.4335178063254, 34.4628926113528 
31.4359531417319, 34.460593958153 31.4384232059227, 34.4583458133218 
31.4409272491596, 34.4561488632993 31.4434645113319, 34.4540037791487 
31.4460342221845, 34.4519112163495 31.4486356015497, 34.4498718145952 
31.4512678595813, 34.4478861975964 31.4539301969923, 34.4743127616154 
31.4681043966654, 34.4743127616154 31.4681043966654, 34.4993680288455 
31.4815430851126, 34.4979567535991 31.4821983257671, 34.4947577303384 
31.4837459579996, 34.4915906049213 31.4853411206382, 34.4911862850778 
31.4855529654203, 34.4607591078457 31.4692345986305, 34.4596847958284 
31.4695965472927, 34.4562266213771 31.4708216658667, 34.4527938273347 
31.4720982335203, 34.4493874547891 31.4734258634554, 34.4460085369521 
31.4748041533856, 34.4426580988495 31.4762326856563, 34.4599206749855 
31.5052751195827))}, NTS.Geometries.Geometry geom1 = {POLYGON ((
34.5431747791894 31.5880715000537, 34.5456552475145 31.5474995447779, 
34.4838900024857 31.5456009437648, 34.5163702622719 31.6002454992081, 
34.5431747791894 31.5880715000537))";
            const string wkt2 = @"POLYGON ((34.5431747791894 31.5880715000537, 34.5456552475145 
31.5474995447779, 34.4838900024857 31.5456009437648, 34.5163702622719 
31.6002454992081, 34.5431747791894 31.5880715000537))";

            var g1 = this.reader.Read(wkt1);
            Assert.IsTrue(g1.IsValid);
            var g2 = this.reader.Read(wkt2);
            Assert.IsTrue(g2.IsValid);

            var union = g1.Union(g2);
            Assert.IsNotNull(union.IsValid);
            Assert.IsTrue(union.IsValid);
        }       
    }
}